---
// --- FRONTMATTER: JAVASCRIPT & DATA FETCHING ---

// Import necessary components & functions
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';

// Import Site data
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

// initialize featuredPosts as an empty array to prevent errors.
let featuredPosts = []; 

try {
    // try to fetch and sort the posts.
    const posts = (await getCollection('blog')).sort(
        (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
    );
    // if successful, we get the 3 most recent posts.
    featuredPosts = posts.slice(0, 3);
} catch (e) {
    // If it fails (e.g., no posts, or a post has a bad date), 
    // we log a helpful error to the terminal and continue with an empty array.
    console.error("Error fetching blog posts. Please ensure you have at least one .md file in 'src/content/blog/' with a valid 'pubDate' in its frontmatter.");
}
---

<!-- --- TEMPLATE: HTML & ASTRO COMPONENTS --- -->

<!doctype html>
<html lang="en">
    <head>
        <BaseHead
            title="Tomintech - Growth Strategist"
            description="I fuse data-driven content with AI-powered automation to deliver real, measurable results for Web3 projects."
        />
        <style>
            main {
                width: 90%;
                max-width: 960px;
                margin: auto;
            }
            section {
                padding: 4rem 0;
                border-bottom: 1px solid #f0f0f0;
            }
            section:last-of-type {
                border-bottom: none;
            }
            .hero {
                text-align: center;
                padding-top: 6rem;
            }
            .hero h1 {
                font-size: clamp(2.5rem, 5vw, 3.5rem);
                font-weight: 800;
                margin-bottom: 1rem;
                line-height: 1.2;
            }
            .hero .subheading {
                font-size: 1.2rem;
                max-width: 600px;
                margin: auto;
                color: #4a5568;
            }
            .hero .cta-buttons {
                margin-top: 2.5rem;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
            }
            .button {
                display: inline-block;
                padding: 0.75rem 1.5rem;
                border-radius: 8px;
                text-decoration: none;
                font-weight: 600;
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            }
            .button.primary {
                background-color: #2d3748;
                color: white;
            }
            .button.secondary {
                background-color: transparent;
                color: #2d3748;
                border: 1px solid #cbd5e0;
            }
            .section-title {
                font-size: 2.5rem;
                font-weight: 700;
                margin-bottom: 2.5rem;
                text-align: center;
            }
            .service-grid, .post-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            @media (min-width: 640px) {
                .post-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
            }
            @media (min-width: 960px) {
                .service-grid {
                    grid-template-columns: repeat(3, 1fr);
                }
                 .post-grid {
                    grid-template-columns: repeat(3, 1fr);
                }
            }
            .service-card, .post-card {
                padding: 1.5rem;
                border: 1px solid #e2e8f0;
                border-radius: 12px;
                background-color: white;
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .service-card:hover, .post-card:hover {
                 transform: translateY(-4px);
                 box-shadow: 0 6px 15px rgba(0,0,0,0.08);
            }
             .post-card a {
                text-decoration: none;
                color: inherit;
                display: block;
                height: 100%;
            }
            .post-card img {
                width: 100%;
                aspect-ratio: 16 / 9;
                object-fit: cover;
                border-radius: 8px;
                margin-bottom: 1rem;
            }
             .post-card .category {
                display: inline-block;
                padding: 0.25rem 0.6rem;
                background-color: #edf2f7;
                color: #4a5568;
                border-radius: 999px;
                font-size: 0.8rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
            }
            .post-card h3 {
                margin-bottom: 0.5rem;
            }
        </style>
    </head>
    <body>
        <Header />
        <main>
            <!-- ====================================================== -->
            <!-- HERO SECTION -->
            <!-- ====================================================== -->
            <section class="hero">
                <h1>Systems that scale growth.</h1>
                <p class="subheading">
                    Building the intelligent infrastructure behind growth‚ÄîML models that predict customer behavior, automation systems that act on insights, and dashboards that prove ROI.
                </p>
                <div class="cta-buttons">
                    <a href="/services" class="button primary">Explore My Services</a>
                    <a href="/blog" class="button secondary">Project Breakdowns</a>
                </div>
            </section>

            <!-- ====================================================== -->
            <!-- SERVICES SECTION -->
            <!-- ====================================================== -->
            <section class="services">
                <h2 class="section-title">From Strategy to Stack: Full-Funnel Growth</h2>
                <div class="service-grid">
                    <article class="service-card">
                        <h3>Content and growth systems</h3>
                        <p>I develop data-driven content strategies that capture organic traffic worth thousands. By analyzing on-chain data and user behavior, I build content funnels that establish authority and drive conversions.</p>
                    </article>
                    <article class="service-card">
                        <h3>Automation</h3>
                        <p>Stop manual work; start scaling intelligently. I design and build custom automation workflows using Python and platforms like n8n to handle everything from content creation to lead management.</p>
                    </article>
                    <article class="service-card">
                        <h3>üõ†Ô∏è Custom Web3 and data tools</h3>
                        <p>Need a specific tool? I build it. From real-time on-chain monitoring dashboards with Flask and Web3.py to custom analytics solutions, I can create the technical tools your project needs to gain a competitive edge.</p>
                    </article>
                </div>
            </section>

            <!-- ====================================================== -->
            <!-- FEATURED POSTS SECTION -->
            <!-- ====================================================== -->
            <section class="featured-posts">
                <h2 class="section-title">The Lab is Open: From Theory to Practice</h2>
                 <div class="post-grid">
                    {
                        featuredPosts.length > 0 ? (
                            featuredPosts.map((post) => (
                                <article class="post-card">
                                   <a href={`/blog/${post.slug}/`}>
                                        {post.data.heroImage && <img src={post.data.heroImage} alt="" />}
                                        {post.data.category && <span class="category">{post.data.category}</span>}
                                        <h3>{post.data.title}</h3>
                                        <p>{post.data.description}</p>
                                    </a>
                                </article>
                            ))
                        ) : (
                            <p style="text-align: center; color: #718096;">No posts yet. Check back soon!</p>
                        )
                    }
                </div>
                 <div style="text-align: center; margin-top: 2.5rem;">
                     <a href="/blog" class="button primary">View All Posts</a>
                 </div>
            </section>

        </main>
        <Footer />
    </body>
</html>